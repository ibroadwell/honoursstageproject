Starting application tasks...
Building kmeans categorisation...
DataFrame before imputation:
           stop_id                      stop_name   stop_lat  stop_lon  postcode     oa21cd  ... oa21pop postcode_pop  employed_total  bus_commute_total  avg_weekly_frequency_per_hour  customer_convenience_score
0     2200YEA00378         Hessle Boothferry Road  53.732380 -0.434509  HU13 9AT  E00065616  ...   255.0         36.0           132.0                0.0                       1.035443                      0.2451
1     2200YEA00936                 Hessle Darleys  53.732969 -0.435579  HU13 9AT  E00065616  ...   255.0         36.0           132.0                0.0                       1.000000                      0.2437
2     2290YHA00591       Hessle Road Fire Station  53.725595 -0.416194   HU4 7BG  E00064998  ...   228.0         21.0            97.0                8.0                       1.959743                      0.4490
3     2290YHA00976                  Winship Close  53.739096 -0.358721   HU3 2QN  E00064825  ...   374.0         24.0           129.0                8.0                       2.561829                      0.4773
4     2200YEA00977             Coniston Hull Road  53.797082 -0.248579  HU11 4LD  E00065744  ...   322.0         47.0           176.0                0.0                       0.990257                      0.2532
...            ...                            ...        ...       ...       ...        ...  ...     ...          ...             ...                ...                            ...                         ...
3729  3200YNA01086        Allerston (Cayley Arms)  54.235375 -0.656900  YO18 7PJ  E00141614  ...   309.0          4.0           140.0                1.0                       0.622729                      0.2459
3730  3200YNA00867                     Copse Hill  54.215756 -0.303359  YO14 9NG  E00141774  ...   452.0          8.0           230.0                9.0                       2.234014                      0.4281
3731  2200YEA01445  Sutton On Derwent Main Street  53.905988 -0.927631  YO41 4BT  E00065900  ...   317.0        144.0           161.0                0.0                       1.000000                      0.2280
3732  3200YNA01077                   Barkers Lane  54.226781 -0.582243  YO13 9AG  E00141698  ...   253.0         23.0           104.0                2.0                       0.655043                      0.2824
3733  3200YNA01078                 Primary School  54.226797 -0.581353  YO13 9AG  E00141698  ...   253.0         23.0           104.0                2.0                       0.622729                      0.2809

[3734 rows x 15 columns]

Calculated median for 'shops_nearby_count': 2.0
Calculated median for 'oa21pop': 301.0
Calculated median for 'employed_total': 139.0

DataFrame after imputation:
           stop_id                      stop_name   stop_lat  stop_lon  postcode     oa21cd  ... oa21pop postcode_pop  employed_total  bus_commute_total  avg_weekly_frequency_per_hour  customer_convenience_score
0     2200YEA00378         Hessle Boothferry Road  53.732380 -0.434509  HU13 9AT  E00065616  ...   255.0         36.0           132.0                0.0                       1.035443                      0.2451
1     2200YEA00936                 Hessle Darleys  53.732969 -0.435579  HU13 9AT  E00065616  ...   255.0         36.0           132.0                0.0                       1.000000                      0.2437
2     2290YHA00591       Hessle Road Fire Station  53.725595 -0.416194   HU4 7BG  E00064998  ...   228.0         21.0            97.0                8.0                       1.959743                      0.4490
3     2290YHA00976                  Winship Close  53.739096 -0.358721   HU3 2QN  E00064825  ...   374.0         24.0           129.0                8.0                       2.561829                      0.4773
4     2200YEA00977             Coniston Hull Road  53.797082 -0.248579  HU11 4LD  E00065744  ...   322.0         47.0           176.0                0.0                       0.990257                      0.2532
...            ...                            ...        ...       ...       ...        ...  ...     ...          ...             ...                ...                            ...                         ...
3729  3200YNA01086        Allerston (Cayley Arms)  54.235375 -0.656900  YO18 7PJ  E00141614  ...   309.0          4.0           140.0                1.0                       0.622729                      0.2459
3730  3200YNA00867                     Copse Hill  54.215756 -0.303359  YO14 9NG  E00141774  ...   452.0          8.0           230.0                9.0                       2.234014                      0.4281
3731  2200YEA01445  Sutton On Derwent Main Street  53.905988 -0.927631  YO41 4BT  E00065900  ...   317.0        144.0           161.0                0.0                       1.000000                      0.2280
3732  3200YNA01077                   Barkers Lane  54.226781 -0.582243  YO13 9AG  E00141698  ...   253.0         23.0           104.0                2.0                       0.655043                      0.2824
3733  3200YNA01078                 Primary School  54.226797 -0.581353  YO13 9AG  E00141698  ...   253.0         23.0           104.0                2.0                       0.622729                      0.2809

[3734 rows x 15 columns]

Loaded cluster mapping from JSON.
Added 'cluster_category' column to the DataFrame.
K-Means model saved to 'kmeans_model.joblib'
StandardScaler saved to 'scaler.joblib'
Clustering complete. Found 3 clusters.

First 5 rows with new cluster labels:
                  stop_name  oa21pop  shops_nearby_count  employed_total  cluster
0    Hessle Boothferry Road    255.0                   1           132.0        0
1            Hessle Darleys    255.0                   1           132.0        0
2  Hessle Road Fire Station    228.0                  13            97.0        0
3             Winship Close    374.0                  15           129.0        0
4        Coniston Hull Road    322.0                   1           176.0        2

Cluster Summary (Mean values for each feature):
            oa21pop  shops_nearby_count  employed_total
cluster                                                
0        267.932153            6.754741      118.145807
1        249.864000          230.528000      136.632000
2        399.850324            6.002427      188.368123
Completed kmeans categorisation.
All application tasks completed successfully.
